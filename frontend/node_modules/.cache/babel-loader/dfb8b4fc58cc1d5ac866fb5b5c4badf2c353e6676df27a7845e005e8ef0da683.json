{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Routes,Route}from'react-router-dom';import{ethers}from'ethers';import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import Header from'./components/Header';import Dashboard from'./components/Dashboard';import Voting from'./components/Voting';import Admin from'./components/Admin';import{VotingContract}from'./contracts/VotingContract';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[account,setAccount]=useState(null);const[provider,setProvider]=useState(null);const[contract,setContract]=useState(null);const[isAdmin,setIsAdmin]=useState(false);const[loading,setLoading]=useState(true);useEffect(()=>{initializeApp();},[]);const initializeApp=async()=>{try{console.log('Initializing app...');// Check if MetaMask is installed\nif(typeof window.ethereum!=='undefined'){console.log('MetaMask detected');const provider=new ethers.BrowserProvider(window.ethereum);setProvider(provider);// Get connected accounts\nconst accounts=await provider.listAccounts();console.log('Connected accounts:',accounts);if(accounts.length>0){await connectWallet(accounts[0]);}// Listen for account changes\nwindow.ethereum.on('accountsChanged',async accounts=>{console.log('Account changed:',accounts);if(accounts.length>0){await connectWallet(accounts[0]);}else{setAccount(null);setContract(null);setIsAdmin(false);}});}else{console.log('MetaMask not detected');toast.error('Please install MetaMask to use this dApp');}}catch(error){console.error('Error initializing app:',error);toast.error('Failed to initialize the application');}finally{setLoading(false);}};const connectWallet=async accountAddress=>{try{console.log('Connecting wallet:',accountAddress);setAccount(accountAddress);// Initialize contract\nconst signer=await provider.getSigner();console.log('Got signer');const votingContract=new VotingContract(signer);console.log('Created voting contract instance');setContract(votingContract);// Check if user is admin\nconst owner=await votingContract.getOwner();console.log('Contract owner:',owner);setIsAdmin(owner.toLowerCase()===accountAddress.toLowerCase());toast.success('Wallet connected successfully!');}catch(error){console.error('Error connecting wallet:',error);toast.error('Failed to connect wallet');}};const connectMetaMask=async()=>{try{if(typeof window.ethereum!=='undefined'){const accounts=await window.ethereum.request({method:'eth_requestAccounts'});await connectWallet(accounts[0]);}else{toast.error('Please install MetaMask');}}catch(error){console.error('Error connecting MetaMask:',error);toast.error('Failed to connect MetaMask');}};const disconnectWallet=()=>{setAccount(null);setContract(null);setIsAdmin(false);toast.info('Wallet disconnected');};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-white text-2xl mb-4\",children:\"Loading USA 2028 Voting dApp...\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-white/70 text-lg\",children:\"Please ensure MetaMask is installed and connected\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen\",children:[/*#__PURE__*/_jsx(Header,{account:account,isAdmin:isAdmin,onConnect:connectMetaMask,onDisconnect:disconnectWallet}),/*#__PURE__*/_jsx(\"main\",{className:\"container mx-auto px-4 py-8\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Dashboard,{contract:contract,account:account,isAdmin:isAdmin})}),/*#__PURE__*/_jsx(Route,{path:\"/vote\",element:/*#__PURE__*/_jsx(Voting,{contract:contract,account:account})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(Admin,{contract:contract,account:account,isAdmin:isAdmin})})]})}),/*#__PURE__*/_jsx(ToastContainer,{position:\"top-right\",autoClose:5000,hideProgressBar:false,newestOnTop:false,closeOnClick:true,rtl:false,pauseOnFocusLoss:true,draggable:true,pauseOnHover:true})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","Routes","Route","ethers","ToastContainer","toast","Header","Dashboard","Voting","Admin","VotingContract","jsx","_jsx","jsxs","_jsxs","App","account","setAccount","provider","setProvider","contract","setContract","isAdmin","setIsAdmin","loading","setLoading","initializeApp","console","log","window","ethereum","BrowserProvider","accounts","listAccounts","length","connectWallet","on","error","accountAddress","signer","getSigner","votingContract","owner","getOwner","toLowerCase","success","connectMetaMask","request","method","disconnectWallet","info","className","children","onConnect","onDisconnect","path","element","position","autoClose","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","draggable","pauseOnHover"],"sources":["/home/zoe/USA-2028/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Routes, Route } from 'react-router-dom';\nimport { ethers } from 'ethers';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nimport Header from './components/Header';\nimport Dashboard from './components/Dashboard';\nimport Voting from './components/Voting';\nimport Admin from './components/Admin';\nimport { VotingContract } from './contracts/VotingContract';\n\nfunction App() {\n  const [account, setAccount] = useState(null);\n  const [provider, setProvider] = useState(null);\n  const [contract, setContract] = useState(null);\n  const [isAdmin, setIsAdmin] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    initializeApp();\n  }, []);\n\n  const initializeApp = async () => {\n    try {\n      console.log('Initializing app...');\n      \n      // Check if MetaMask is installed\n      if (typeof window.ethereum !== 'undefined') {\n        console.log('MetaMask detected');\n        const provider = new ethers.BrowserProvider(window.ethereum);\n        setProvider(provider);\n\n        // Get connected accounts\n        const accounts = await provider.listAccounts();\n        console.log('Connected accounts:', accounts);\n        \n        if (accounts.length > 0) {\n          await connectWallet(accounts[0]);\n        }\n\n        // Listen for account changes\n        window.ethereum.on('accountsChanged', async (accounts) => {\n          console.log('Account changed:', accounts);\n          if (accounts.length > 0) {\n            await connectWallet(accounts[0]);\n          } else {\n            setAccount(null);\n            setContract(null);\n            setIsAdmin(false);\n          }\n        });\n      } else {\n        console.log('MetaMask not detected');\n        toast.error('Please install MetaMask to use this dApp');\n      }\n    } catch (error) {\n      console.error('Error initializing app:', error);\n      toast.error('Failed to initialize the application');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const connectWallet = async (accountAddress) => {\n    try {\n      console.log('Connecting wallet:', accountAddress);\n      setAccount(accountAddress);\n      \n      // Initialize contract\n      const signer = await provider.getSigner();\n      console.log('Got signer');\n      \n      const votingContract = new VotingContract(signer);\n      console.log('Created voting contract instance');\n      setContract(votingContract);\n\n      // Check if user is admin\n      const owner = await votingContract.getOwner();\n      console.log('Contract owner:', owner);\n      setIsAdmin(owner.toLowerCase() === accountAddress.toLowerCase());\n\n      toast.success('Wallet connected successfully!');\n    } catch (error) {\n      console.error('Error connecting wallet:', error);\n      toast.error('Failed to connect wallet');\n    }\n  };\n\n  const connectMetaMask = async () => {\n    try {\n      if (typeof window.ethereum !== 'undefined') {\n        const accounts = await window.ethereum.request({\n          method: 'eth_requestAccounts'\n        });\n        await connectWallet(accounts[0]);\n      } else {\n        toast.error('Please install MetaMask');\n      }\n    } catch (error) {\n      console.error('Error connecting MetaMask:', error);\n      toast.error('Failed to connect MetaMask');\n    }\n  };\n\n  const disconnectWallet = () => {\n    setAccount(null);\n    setContract(null);\n    setIsAdmin(false);\n    toast.info('Wallet disconnected');\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"text-white text-2xl mb-4\">Loading USA 2028 Voting dApp...</div>\n          <div className=\"text-white/70 text-lg\">Please ensure MetaMask is installed and connected</div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen\">\n      <Header \n        account={account} \n        isAdmin={isAdmin}\n        onConnect={connectMetaMask}\n        onDisconnect={disconnectWallet}\n      />\n      \n      <main className=\"container mx-auto px-4 py-8\">\n        <Routes>\n          <Route \n            path=\"/\" \n            element={\n              <Dashboard \n                contract={contract}\n                account={account}\n                isAdmin={isAdmin}\n              />\n            } \n          />\n          <Route \n            path=\"/vote\" \n            element={\n              <Voting \n                contract={contract}\n                account={account}\n              />\n            } \n          />\n          <Route \n            path=\"/admin\" \n            element={\n              <Admin \n                contract={contract}\n                account={account}\n                isAdmin={isAdmin}\n              />\n            } \n          />\n        </Routes>\n      </main>\n\n      <ToastContainer \n        position=\"top-right\"\n        autoClose={5000}\n        hideProgressBar={false}\n        newestOnTop={false}\n        closeOnClick\n        rtl={false}\n        pauseOnFocusLoss\n        draggable\n        pauseOnHover\n      />\n    </div>\n  );\n}\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}